<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Client</title>
</head>
<body>
  <h2>WebSocket Client</h2>
  <input id="fibValue" type="number" placeholder="Digite n para Fibonacci" />
  <button onclick="sendFibonacci()">Enviar Fibonacci</button>
  <div>##################################### </div>
  <div>
    <button onclick="conectarWebSocket()">Conectar</button>
    <button onclick="desconectarWebSocket()">Desconectar</button>
    <button onclick="limpar()">Limpar log</button>
  </div>
  <pre id="output"></pre>

  <script>
    let socket = null;
  
    const MsgConectado = [
    "üü¢ Conectado com sucesso! üöÄ‚ú®",
    "üîå Conex√£o estabelecida! üß†üí•",
    "‚úÖ Tudo certo! Est√° online. üåêüòé",
    "üîó Ja estou conectado... mas se insistir, eu desconecto!!",
    "üéâ Link com o servidor ativo! üì°üî•"
    ];
    let iContMsgConectado = 0;

    const MsgDesconectado = [
    "üî¥ Desconectado. üò¢",  
    "‚ùå Mais desconectado do que isso, imposs√≠vel! ü´•üì¥",
    "üì¥ J√° foi!!. üò¥üí§",
    "üîå Eitaa, Ja desconectamos. üò¢",
    "üèÉ‚Äç‚ôÇÔ∏è Ta bom... eu entendi! üèùÔ∏èüò≠"
    ];
    let iContMsgDeconectado = 0;

    const MsgJaConectado = [
    "üì∂ Conex√£o j√° est√° ativa. üõúüéØ",
    "ü§∑‚Äç‚ôÇÔ∏è Se eu conectar mais, viro um MEGAZORD üòÜ",
    "üôÖ‚Äç‚ôÇÔ∏è N√£o precisa conectar de novo! üîÅüö´",
    "üòÖ J√° estamos online, lembra? üß†üíæ",
    "üßê N√£o √© possiel... deve ter clicado errado..  üßªüö™"
    ];
    let iContMsgJaConectado = 0;

    const MsgJaDeconectado = [
    "üì¥ J√° estamos desconectados! üí§",
    "üòë N√£o d√° pra desligar o que j√° est√° desligado. ü™´",
    "üîï E se... no proximo click eu desligar o PC??. üôà",
    "üôÑ Voc√™ j√° abandonou o servidor. üèÉ‚Äç‚ôÄÔ∏èüí®"
    ];
    let iContMsgJaDeconectado = 0;

    function limpar() {
      document.getElementById("output").textContent = "";
    }

    function log(msg) {
      document.getElementById("output").textContent += msg + "\n";
    }
  
    function conectarWebSocket() {
      if (socket && socket.readyState === WebSocket.OPEN) {
        log(MsgJaConectado[iContMsgJaConectado]);
        iContMsgJaConectado = (iContMsgJaConectado + 1) % MsgJaConectado.length;
        return;
      }
  
      socket = new WebSocket("ws://localhost:8000/ws");
  
      socket.onopen = () => {
        log(MsgConectado[iContMsgConectado]);
        iContMsgConectado = (iContMsgConectado + 1) % MsgConectado.length;
      };
  
      socket.onmessage = (event) => {
        log("Servidor: " + event.data);
      };
  
      socket.onclose = () => {
        log("Conex√£o encerrada.");
      };
  
      socket.onerror = (error) => {
        log("Erro na conex√£o WebSocket.");
        console.error(error);
      };
    }
  
    function desconectarWebSocket() {
      if (!socket || socket.readyState === WebSocket.CLOSED) {
        log(MsgJaDeconectado[iContMsgJaDeconectado]);
        iContMsgJaDeconectado = (iContMsgJaDeconectado + 1) % MsgJaDeconectado.length;
        return;
      }
  
      socket.close();
      log(MsgDesconectado[iContMsgDeconectado]);
      iContMsgDeconectado = (iContMsgDeconectado + 1) % MsgDesconectado.length;
    }
  
    function sendFibonacci() {
      const value = parseInt(document.getElementById("fibValue").value || "10");
      if (socket && socket.readyState === WebSocket.OPEN) {
        socket.send(JSON.stringify({ command: "fibonacci", value }));
      } else {
        log("Conecte-se antes de enviar.");
      }
    }
  </script>
      
</body>
</html>
